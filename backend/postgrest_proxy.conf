events {
    worker_connections 1024;
}

http {
    server {
        listen 3002;
        
        # Rewrite /rest/v1/ path to root for PostgREST
        location /rest/v1/ {
            proxy_pass http://postgrest:3001/;
            proxy_set_header Host $host;
            proxy_set_header Content-Type application/json;
        }

        # Fallback for other paths
        location / {
            proxy_pass http://postgrest:3001/;
            proxy_set_header Host $host;
        }
    }
}
